契约锁电子签章系统未授权 RCE 漏洞（QVD-2025-23408）POC 工具 README
1. 工具概述
本工具用于检测契约锁电子签章系统是否存在编号为 QVD-2025-23408 的未授权远程命令执行（RCE）漏洞。该漏洞源于系统特定接口对用户输入校验不严格，攻击者可通过构造恶意请求触发远程命令执行，获取目标服务器控制权。

工具支持单 URL 检测和批量 URL 检测两种模式，采用多线程（100 线程）提升批量检测效率，并自动将存在漏洞的目标保存至结果文件，方便后续处理。
2. 漏洞信息
项目	描述
漏洞编号	QVD-2025-23408
漏洞名称	契约锁电子签章系统未授权 RCE 漏洞
漏洞类型	远程命令执行（RCE）
风险等级	高危（CVSS 3.x 评分预计 9.8+，未授权访问 + 远程代码执行）
影响范围	契约锁电子签章系统特定版本（具体受影响版本需参考官方漏洞公告）
漏洞原理	系统/setup/dbtest接口未校验socketFactory等参数，攻击者可注入恶意 XML payload，触发ClassPathXmlApplicationContext加载远程恶意配置，进而执行命令。
3. 环境依赖
3.1 运行环境
Python 3.6 及以上版本（推荐 Python 3.8+）
支持 Windows、Linux、macOS 等主流操作系统
3.2 依赖库
工具依赖以下 Python 第三方库，需提前安装：

bash
pip install requests argparse multiprocessing

（注：argparse、multiprocessing 为 Python 标准库，通常无需额外安装；requests 为第三方库，需手动安装）
4. 工具使用说明
4.1 命令格式
工具通过命令行参数指定检测模式，基本格式如下：

bash
python [工具文件名].py [参数]
4.2 参数说明
参数	简写	功能描述
--url	-u	单 URL 检测，指定待检测的目标 URL（例如：http://192.168.1.100）
--file	-f	批量检测，指定包含多个 URL 的文本文件路径（文件中每行一个 URL，需去除空格）
--help	-h	查看工具帮助信息，显示参数说明
4.3 使用示例
示例 1：单 URL 检测
检测单个目标是否存在漏洞：

bash
python qvd-2025-23408-poc.py -u http://192.168.1.100:8080
示例 2：批量 URL 检测
从 urls.txt 文件中读取多个目标 URL，批量检测：

bash
python qvd-2025-23408-poc.py -f urls.txt

urls.txt 文件格式要求：每行一个目标 URL，示例如下：
plaintext
http://192.168.1.100
https://10.0.0.5:8443
http://example.com:8080

5. 结果说明
5.1 控制台输出
工具运行时会实时在控制台输出检测结果，不同前缀代表不同含义：

[+] [URL] 存在远程命令执行：目标存在漏洞，已记录到结果文件
[-] [URL] 不存在远程命令执行：目标不存在漏洞
[*] [URL] 访问有问题，请手工检查：目标无法正常访问（如网络不通、端口关闭、HTTP 状态码非 200 等）
无输出：目标访问超时或发生其他异常（如连接拒绝、SSL 证书错误等，已通过 try-except 捕获并忽略）
5.2 结果文件
工具会自动在当前目录生成 result.txt 文件，仅保存存在漏洞的目标 URL（每行一个）
若多次运行工具，结果会追加到文件末尾（不会覆盖历史数据）
6. 注意事项
合法性声明
本工具仅用于合法授权的渗透测试、漏洞验证，严禁用于未授权的攻击行为。
使用前需确保已获得目标系统的书面授权，否则一切法律责任由使用者自行承担。
网络环境
批量检测默认使用 100 线程，若目标数量过多或网络带宽有限，可修改代码中 Pool(100) 为更小数值（如 Pool(50)），避免触发目标防护设备拦截。
工具已通过 urllib3.disable_warnings 忽略 SSL 证书验证警告，支持检测 HTTPS 目标，但仍建议优先确认目标 SSL 证书有效性（如需启用证书验证，可删除 verify=False 参数）。
Payload 说明
工具中 payload 包含远程 XML 地址（http://100.XX.XXX.85:8099/1.xml），使用前需替换为自己控制的 XML 服务器地址（需确保 XML 文件可正常访问，且包含恶意命令逻辑）。
若仅需验证漏洞存在性，可简化 Payload（如无需执行命令，仅检测参数注入是否生效），避免触发目标系统告警。
版本兼容性
本工具仅针对 QVD-2025-23408 漏洞设计，若目标系统已修复该漏洞，检测结果可能不准确，建议结合官方补丁信息进一步确认。
7. 漏洞修复建议
立即联系契约锁官方获取漏洞修复补丁，升级至安全版本（参考官方漏洞公告）。
临时防护措施：
限制 setup/dbtest 接口的访问权限（如仅允许内网 IP 访问，通过防火墙、WAF 配置访问控制策略）。
对接口输入参数（如 socketFactory、socketFactoryArg）进行严格校验，禁止特殊字符（如 http://、:、/ 等）注入。
定期对系统进行漏洞扫描，排查是否存在其他未修复的安全隐患。
